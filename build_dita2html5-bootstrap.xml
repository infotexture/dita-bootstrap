<?xml version='1.0' encoding='UTF-8'?>
<!-- Copyright © 2017 · infotexture · Roger W. Fienhold Sheen -->
<!-- See the accompanying LICENSE file for applicable license -->
<project xmlns:if="ant:if">
  <target
    name="dita2html5-bootstrap"
    depends="dita2html5-bootstrap.init,
             dita2html5"
  />

  <target
    name="bootstrap.scripts.copy"
    depends="bootstrap.scripts.popover,
             bootstrap.scripts.dark.mode"
  />

  <target name="dita-bootstrap.css.copy" description="Copy CSS files">
    <property
      name="dita-bootstrap.css.dir"
      value="${dita.plugin.net.infotexture.dita-bootstrap.dir}/css/"
    />

    <!-- Common Bootstrap overrides for DITA-OT css -->
    <loadfile
      property="dita-bootstrap.css"
      srcFile="${dita-bootstrap.css.dir}/common-bootstrap.css"
    />
    <echo
      append="true"
      message="${line.separator}${dita-bootstrap.css}"
      file="${extend.css.file}"
    />

    <!-- Add Bootstrap side-toc css unless nav-toc=none -->
    <condition
      property="dita-bootstrap.side-toc.css.file"
      value="${dita-bootstrap.css.dir}/none-toc.css"
    >
      <equals arg1="${nav-toc}" arg2="none"/>
    </condition>
    <property
      name="dita-bootstrap.side-toc.css.file"
      value="${dita-bootstrap.css.dir}/side-toc.css"
    />

    <loadfile
      property="dita-bootstrap.side-toc"
      srcFile="${dita-bootstrap.side-toc.css.file}"
    />
    <echo
      append="true"
      message="${line.separator}${dita-bootstrap.side-toc}"
      file="${extend.css.file}"
    />

    <!-- Add Bootstrap menubar-toc css if menubar-toc.include=yes -->
    <condition
      property="dita-bootstrap.menubar-toc.css.file"
      value="${dita-bootstrap.css.dir}/menubar-toc.css"
    >
      <equals arg1="${menubar-toc.include}" arg2="yes"/>
    </condition>

    <loadfile
      if:set="dita-bootstrap.menubar-toc.css.file"
      property="dita-bootstrap.menubar-toc"
      srcFile="${dita-bootstrap.menubar-toc.css.file}"
    />
    <echo
      if:set="dita-bootstrap.menubar-toc.css.file"
      append="true"
      message="${line.separator}${dita-bootstrap.menubar-toc}"
      file="${extend.css.file}"
    />

    <!-- Add Bootstrap collapsible css if collapsible.include=yes -->
    <condition
      property="dita-bootstrap.collapsible.css.file"
      value="${dita-bootstrap.css.dir}/collapsible-toc.css"
    >
       <equals arg1="${nav-toc}" arg2="collapsible"/>
    </condition>

    <loadfile
      if:set="dita-bootstrap.collapsible.css.file"
      property="dita-bootstrap.collapsible"
      srcFile="${dita-bootstrap.collapsible.css.file}"
    />
    <echo
      if:set="dita-bootstrap.collapsible.css.file"
      append="true"
      message="${line.separator}${dita-bootstrap.collapsible}"
      file="${extend.css.file}"
    />
  </target>

  <target name="bootstrap.scripts.popover" if="bootstrap.copy.popover">
    <!-- Add initialization script for popovers and tooltips -->
    <mkdir dir="${dita.output.dir}/js"/>
    <copy todir="${dita.output.dir}/js">
      <fileset
        dir="${dita.plugin.net.infotexture.dita-bootstrap.dir}/includes"
        includes="popovers.js"
      />
    </copy>
  </target>

  <target name="bootstrap.scripts.dark.mode" if="bootstrap.copy.dark.mode">
    <!-- Add dark mode initialization script -->
    <mkdir dir="${dita.output.dir}/js"/>
    <copy todir="${dita.output.dir}/js">
      <fileset
        dir="${dita.plugin.net.infotexture.dita-bootstrap.dir}/includes"
        includes="dark-mode.js"
      />
    </copy>
  </target>

  <target name="dita2html5-bootstrap.init">
    <property
      name="icons.cdn.path"
      location="${dita.plugin.net.infotexture.dita-bootstrap.dir}/includes/bootstrap.icons.hdf.xml"
    />
    <property name="icons.include" value="no"/>
    <property
      name="args.hdf"
      location="${dita.plugin.net.infotexture.dita-bootstrap.dir}/includes/bootstrap.hdf.xml"
    />
    <property
      name="args.hdr"
      location="${dita.plugin.net.infotexture.dita-bootstrap.dir}/includes/bs-navbar-default.hdr.xml"
    />
    <property
      name="args.xsl"
      location="${dita.plugin.net.infotexture.dita-bootstrap.dir}/xsl/html5-bootstrap.xsl"
    />
    <property name="args.html5.toc" value="toc"/>
    <property name="nav-toc" value="partial"/>
    <property name="args.copycss" value="yes"/>
    <property name="args.csspath" value="css"/>
    <property name="menubar-toc.include" value="no"/>
    <property name="popovers.include" value="no"/>
    <property name="dark.mode.include" value="no"/>

    <!-- Add included javascript functions if required -->
    <condition property="bootstrap.copy.popover">
      <equals arg1="${popovers.include}" arg2="yes"/>
    </condition>
    <condition property="bootstrap.copy.dark.mode">
      <equals arg1="${dark.mode.include}" arg2="yes"/>
    </condition>
  </target>
</project>
